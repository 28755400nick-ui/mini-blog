{% extends "base.html" %}

{% block title %}Agregar Post - Mini Blog{% endblock %}

{% block content %}
    <h1>Mini Blog</h1>
    <div style="text-align:center; margin: 20px auto; color: #888;">
      <p>Para probar el blog, usa estas credenciales:</p>
      <p>Usuario demo: <strong>{{ demo_user }}</strong> | ContraseÃ±a: <strong>{{ demo_pass }}</strong></p>
      <a href="{{ url_for('login') }}" class="btn-agregar">Iniciar sesiÃ³n</a>
    </div>
    {% if session.get("user") %}
    <h3 style="text-align:center;">Hola, {{ session.get("user") }} ðŸ‘‹</h3>
    {% endif %}
  <a href="/add" class="btn-agregar">Agregar nuevo post</a>
  <form action="{{ url_for('search') }}" method="get" class="search-form">
    <input type="text" name="q" placeholder="Buscar posts..." required>
    <button type="submit">Buscar</button>
  </form>
  <div class="post-container">
    {% for post in posts %}
      <div class="card-post">
        <h2>
          <a href="{{ url_for('post_detail', id=post.id) }}" style="color: #007bff; text-decoration: none;">
            {{ post.title }}
          </a>
        </h2>      
        {% if post.category %}
          <p><strong>CategorÃ­a:</strong> {{ post.category }}</p>
        {% endif %}
        
        {% if post.tags %}
          <div class="tags">
            {% for tag in post.tags.split(",") %}
              <a href="{{ url_for('search', q=tag.strip()) }}" class="tag-chip">{{ tag.strip() }}</a>
            {% endfor %}
          </div>
        {% endif %}

        {% if post.created_at %}
          <small>Publicado el {{ post.created_at.strftime('%d/%m/%Y %H:%M') }}</small>
        {% endif %}

        <p>{{ post.content }}</p>

        {% if post.image_url %}
          <img src="{{ url_for('static', filename='uploads/' ~ post.image_url) }}" alt="Imagen del post" class="image-post">
        {% endif %}
        
        <div class="actions">
          <form action="/edit/{{post.id}}" method="get" style="display: inline;">
            <button type="submit">Editar</button>
          </form>
          <form action="/delete/{{post.id}}" method="get" style="display:inline;" onsubmit="return confirm('Â¿EstÃ¡s seguro de que quieres eliminar este post?');">
            <button type="submit">Eliminar</button>
          </form>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock %}